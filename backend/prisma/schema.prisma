generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Scan {
  uuid         String   @id
  url          String
  timestamp    DateTime
  status       String
  progress     Int
  spiderScanId String?
  activeScanId String?
  error        String?
  
  // Relation to alerts
  alerts       Alert[]
}

model Alert {
  id          String   @id @default(uuid())
  scanId      String
  scan        Scan     @relation(fields: [scanId], references: [uuid], onDelete: Cascade)
  
  // ZAP Alert fields
  zapId       String?
  name        String
  risk        String
  description String    @db.Text
  solution    String    @db.Text
  reference   String    @db.Text
  url         String
  evidence    String?   @db.Text
  param       String?
  attack      String?   @db.Text
  other       String?   @db.Text
  confidence  String?
  wascid      String?
  cweid       String?
  
  // JSON field for tags
  tags        Json?
  
  createdAt   DateTime  @default(now())
}
